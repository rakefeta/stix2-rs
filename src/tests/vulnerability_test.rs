use crate::domain_obj::vulnerability::Vulnerability;
use serde_json;

// Datetime format for STIX2 datetime (de)serialization
// const STIX2_DTFORMAT: &str = "%Y-%m-%dT%H:%M:%S%.3fZ";

#[test]
fn vulnerability_deserialization() {

    let json_str = r#"
        {
            "type": "vulnerability",
            "spec_version": "2.1",
            "id": "vulnerability--0c7b5b88-8ff7-4a4d-aa9d-feb398cd0061",
            "created": "2016-05-12T08:17:27.000Z",
            "modified": "2016-05-12T08:17:27.000Z",
            "created_by_ref": "identity--f431f809-377b-45e0-aa1c-6a4751cae5ff",
            "name": "CVE-2016-1234",
            "external_references": [
                {
                "source_name": "cve",
                "external_id": "CVE-2016-1234"
                }
            ]
        }"#;

    let _parsed_indicator: Vulnerability = serde_json::from_str(&json_str).unwrap();
}
